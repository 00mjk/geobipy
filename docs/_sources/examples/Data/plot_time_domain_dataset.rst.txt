
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/Data/plot_time_domain_dataset.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_examples_Data_plot_time_domain_dataset.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_Data_plot_time_domain_dataset.py:


Time domain dataset
--------------------

.. GENERATED FROM PYTHON SOURCE LINES 6-13

.. code-block:: default

    from geobipy import plotting as cP
    from os.path import join
    import matplotlib.pyplot as plt
    import numpy as np
    from geobipy.src.classes.core.StatArray import StatArray
    from geobipy.src.classes.data.dataset.TdemData import TdemData








.. GENERATED FROM PYTHON SOURCE LINES 14-16

Reading in the Data
+++++++++++++++++++

.. GENERATED FROM PYTHON SOURCE LINES 18-24

.. code-block:: default

    dataFolder = "..//supplementary//Data//"
    # The data file name
    dataFiles=[dataFolder + 'Skytem_High.txt', dataFolder + 'Skytem_Low.txt']
    # The EM system file name
    systemFiles=[dataFolder + 'SkytemHM-SLV.stm', dataFolder + 'SkytemLM-SLV.stm']








.. GENERATED FROM PYTHON SOURCE LINES 25-26

Read in the data from file

.. GENERATED FROM PYTHON SOURCE LINES 26-29

.. code-block:: default

    TD = TdemData.read_csv(dataFiles, systemFiles)









.. GENERATED FROM PYTHON SOURCE LINES 30-31

Plot the locations of the data points

.. GENERATED FROM PYTHON SOURCE LINES 31-35

.. code-block:: default

    plt.figure(figsize=(8,6))
    _ = TD.scatter2D()





.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_001.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 36-37

Plot all the data along the specified line

.. GENERATED FROM PYTHON SOURCE LINES 37-40

.. code-block:: default

    plt.figure(figsize=(8,6))
    _ = TD.plotLine(100101.0, log=10)




.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_002.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 41-42

Or, plot specific channels in the data

.. GENERATED FROM PYTHON SOURCE LINES 42-45

.. code-block:: default

    plt.figure(figsize=(8,6))
    _ = TD.plot(system=0, channels=[17, 18, 19], log=10)




.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_003.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 46-52

.. code-block:: default

    plt.figure()
    plt.subplot(211)
    _ = TD.pcolor(system=0, log=10, xscale='log')
    plt.subplot(212)
    _ = TD.pcolor(system=1, log=10, xscale='log')




.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_004.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 53-57

.. code-block:: default

    plt.figure()
    ax = TD.scatter2D(s=1.0, c=TD.dataChannel(system=0, channel=23), equalize=True)
    plt.axis('equal')




.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_005.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none


    (429026.56, 454054.24, 4160662.0, 4200460.0)



.. GENERATED FROM PYTHON SOURCE LINES 58-59

TD.toVTK('TD1', format='binary')

.. GENERATED FROM PYTHON SOURCE LINES 62-64

Obtain a line from the data set
+++++++++++++++++++++++++++++++

.. GENERATED FROM PYTHON SOURCE LINES 64-66

.. code-block:: default

    line = TD.line(100601.0)








.. GENERATED FROM PYTHON SOURCE LINES 67-70

.. code-block:: default

    plt.figure()
    _ = line.scatter2D(c = line.dataChannel(17, system=1))




.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_006.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 71-81

.. code-block:: default

    plt.figure()
    _ = line.plot(xAxis='x', log=10)


    # Prepare the dataset so that we can read a point at a time.
    Dataset = TdemData._initialize_sequential_reading(dataFiles, systemFiles)
    # Get a datapoint from the file.
    DataPoint = Dataset._read_record()





.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_007.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):
    /Users/nfoks/codes/repositories/geobipy/geobipy/src/base/utilities.py:715: RuntimeWarning: All-NaN axis encountered
      if (np.nanmin(values) <= 0.0):




.. GENERATED FROM PYTHON SOURCE LINES 82-88

.. code-block:: default

    dataFolder = "..//supplementary//Data//"
    # The data file name
    dataFiles= dataFolder + 'aerotem.txt'
    # The EM system file name
    systemFiles= dataFolder + 'aerotem.stm'








.. GENERATED FROM PYTHON SOURCE LINES 89-90

Read in the data from file

.. GENERATED FROM PYTHON SOURCE LINES 90-93

.. code-block:: default

    TD = TdemData.read_csv(dataFiles, systemFiles)






.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Warning: Your data contains values that are <= 0.0




.. GENERATED FROM PYTHON SOURCE LINES 94-95

Plot the locations of the data points

.. GENERATED FROM PYTHON SOURCE LINES 95-98

.. code-block:: default

    plt.figure(figsize=(8,6))
    _ = TD.scatter2D()




.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_008.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 99-100

Plot all the data along the specified line

.. GENERATED FROM PYTHON SOURCE LINES 100-103

.. code-block:: default

    plt.figure(figsize=(8,6))
    _ = TD.plotLine(1010.0, log=10)




.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_009.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Values <= 0.0 have been masked before taking their log




.. GENERATED FROM PYTHON SOURCE LINES 104-105

Or, plot specific channels in the data

.. GENERATED FROM PYTHON SOURCE LINES 105-108

.. code-block:: default

    plt.figure(figsize=(8,6))
    _ = TD.plot(system=0, channels=[17, 18, 19], log=10)




.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_010.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 109-112

.. code-block:: default

    plt.figure()
    _ = TD.pcolor(system=0, log=10, xscale='log')




.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_011.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Values <= 0.0 have been masked before taking their log




.. GENERATED FROM PYTHON SOURCE LINES 113-125

.. code-block:: default

    plt.figure()
    ax = TD.scatter2D(s=1.0, c=TD.dataChannel(system=0, channel=23), equalize=True)
    plt.axis('equal')

    # Prepare the dataset so that we can read a point at a time.
    Dataset = TdemData._initialize_sequential_reading(dataFiles, systemFiles)
    # Get a datapoint from the file.
    DataPoint = Dataset._read_record()


    plt.show()




.. image:: /examples/Data/images/sphx_glr_plot_time_domain_dataset_012.png
    :alt: plot time domain dataset
    :class: sphx-glr-single-img





.. GENERATED FROM PYTHON SOURCE LINES 126-176

File Format for time domain data
++++++++++++++++++++++++++++++++
Here we describe the file format for time domain data.

The data columns are read in according to the column names in the first line

In this description, the column name or its alternatives are given followed by what the name represents
Optional columns are also described.

Required columns
________________
line
    Line number for the data point
fid
    Unique identification number of the data point
x or northing or n
    Northing co-ordinate of the data point, (m)
y or easting or e
    Easting co-ordinate of the data point, (m)
z or alt
    Altitude of the transmitter coil above ground level (m)
elevation
    Elevation of the ground at the data point (m)
txrx_dx
    Distance in x between transmitter and reciever (m)
txrx_dy
    Distance in y between transmitter and reciever (m)
txrx_dz
    Distance in z between transmitter and reciever (m)
TxPitch
    Pitch of the transmitter loop
TxRoll
    Roll of the transmitter loop
TxYaw
    Yaw of the transmitter loop
RxPitch
    Pitch of the receiver loop
RxRoll
    Roll of the receiver loop
RxYaw
    Yaw of the receiver loop
Off[0] Off[1] ... Off[last]  - with the number and square brackets
    The measurements for each time gate specified in the accompanying system file under Receiver Window Times
Optional columns
________________
OffErr[0] OffErr[1] ... OffErr[last]
    Estimates of standard deviation for each off time measurement
Example Header
______________
Line fid easting northing elevation height txrx_dx txrx_dy txrx_dz TxPitch TxRoll TxYaw RxPitch RxRoll RxYaw Off[0] Off[1]

.. GENERATED FROM PYTHON SOURCE LINES 178-190

File Format for a time domain system
++++++++++++++++++++++++++++++++++++
Please see Page 13 of Ross Brodie's `instructions`_

.. _instructions: https://github.com/GeoscienceAustralia/ga-aem/blob/master/docs/GA%20AEM%20Programs%20User%20Manual.pdf

We use GA-AEM for our airborne time domain forward modeller.

Example system files are contained in
`the supplementary folder`_ in this repository

.. _the supplementary folder: https://github.com/usgs/geobipy/tree/master/documentation_source/source/examples/supplementary/Data


.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  26.342 seconds)


.. _sphx_glr_download_examples_Data_plot_time_domain_dataset.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_time_domain_dataset.py <plot_time_domain_dataset.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_time_domain_dataset.ipynb <plot_time_domain_dataset.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
