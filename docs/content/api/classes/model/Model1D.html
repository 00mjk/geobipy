

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Model1D &mdash; GeoBIPy 1.0.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../" src="../../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../../_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/graphviz.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/gallery.css" type="text/css" />
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link rel="next" title="Pointcloud classes" href="../pointcloud/pointcloud.html" />
    <link rel="prev" title="Model" href="Model_.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../../index.html" class="icon icon-home"> GeoBIPy
          

          
          </a>

          
            
            
              <div class="version">
                1.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started/getting_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../base/base.html">Core routines needed for GeoBIPy</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../classes.html">Classes used in GeoBIPy</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../core/core.html">Core classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../data/data.html">Data classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../mesh/mesh.html">Mesh classes</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="model.html">Model classes</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Model_.html">Model</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Model1D</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pointcloud/pointcloud.html">Pointcloud classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../statistics/statistics.html">Statistics classes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../system/system.html">System classes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../examples/index.html">Examples</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">GeoBIPy</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../api.html">API</a> &raquo;</li>
        
          <li><a href="../classes.html">Classes used in GeoBIPy</a> &raquo;</li>
        
          <li><a href="model.html">Model classes</a> &raquo;</li>
        
      <li>Model1D</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../../_sources/content/api/classes/model/Model1D.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="model1d">
<h1>Model1D<a class="headerlink" href="#model1d" title="Permalink to this headline">¶</a></h1>
<div class="graphviz"><img src="../../../../_images/inheritance-a96e45ea8b9143901b60fd92b27ebeaaf5a6e71b.png" alt="Inheritance diagram of geobipy.src.classes.model.Model1D" usemap="#inheritance0303cabe1d" class="inheritance graphviz" /></div>
<map id="inheritance0303cabe1d" name="inheritance0303cabe1d">
<area shape="rect" id="node1" href="Model_.html#geobipy.src.classes.model.Model.Model" target="_top" title="Abstract Model Class" alt="" coords="131,5,203,29"/>
<area shape="rect" id="node3" href="#geobipy.src.classes.model.Model1D.Model1D" target="_top" title="Class extension to geobipy.Model" alt="" coords="251,5,326,29"/>
<area shape="rect" id="node2" href="../core/myObject.html#geobipy.src.classes.core.myObject.myObject" target="_top" title="Abstract base class" alt="" coords="5,5,83,29"/>
</map><span class="target" id="module-geobipy.src.classes.model.Model1D"></span><p>&#64;Model1D_Class
Module describing a 1 Dimensional layered Model</p>
<dl class="class">
<dt id="geobipy.src.classes.model.Model1D.Model1D">
<em class="property">class </em><code class="sig-prename descclassname">geobipy.src.classes.model.Model1D.</code><code class="sig-name descname">Model1D</code><span class="sig-paren">(</span><em class="sig-param">nCells=None</em>, <em class="sig-param">top=None</em>, <em class="sig-param">parameters=None</em>, <em class="sig-param">depth=None</em>, <em class="sig-param">thickness=None</em>, <em class="sig-param">hasHalfspace=True</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D" title="Permalink to this definition">¶</a></dt>
<dd><p>Class extension to geobipy.Model</p>
<p>Class creates a representation of the 1D layered earth.
The class contains parameters that describe the physical property of each layer, as well as the layer
thicknesses and interface depths. The model maintains a half space as the lowest layer with infinite extent.
This class allows a probability wheel to be assigned such that the 1D layered earth can be peturbed. i.e.
randomly create, delete, or perturb the layers in the model.  This is a key step in a Markov Chain for Bayesian inference.</p>
<p>Model1D(nCells, top, parameters, depth, thickness)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nCells</strong> (<em>int</em>) – Number of layers in the 1D layered earth. A single layer represents a half space.</p></li>
<li><p><strong>top</strong> (<em>numpy.float64</em><em>, </em><em>optional</em>) – Depth to the top of the model</p></li>
<li><p><strong>parameters</strong> (<em>geobipy.StatArray</em><em>, </em><em>optional</em>) – Describes the variable within each layer of the model.</p></li>
<li><p><strong>depth</strong> (<em>geobipy.StatArray</em><em>, </em><em>optional</em>) – Depths to the lower interface of each layer above the halfspace. Do not provide if thickness is given.</p></li>
<li><p><strong>thickness</strong> (<em>geobipy.StatArray</em><em>, </em><em>optional</em>) – Thickness of each layer above the halfspace. Do not provide if depths are given.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – 1D layered earth model.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#geobipy.src.classes.model.Model1D.Model1D" title="geobipy.src.classes.model.Model1D.Model1D">Model1D</a></p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If nCells is &lt;= 0</p></li>
<li><p><strong>ValueError</strong> – If size(parameters) != nCells</p></li>
<li><p><strong>ValueError</strong> – If size(depth) != nCells - 1</p></li>
<li><p><strong>ValueError</strong> – If size(thickness) != nCells - 1</p></li>
<li><p><strong>TypeError</strong> – If both depth and thickness are provided</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.addToHitMap">
<code class="sig-name descname">addToHitMap</code><span class="sig-paren">(</span><em class="sig-param">Hitmap</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.addToHitMap" title="Permalink to this definition">¶</a></dt>
<dd><p>Imposes a model’s parameters with depth onto a 2D Hitmap.</p>
<p>The cells that the parameter-depth profile passes through are accumulated by 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Hitmap</strong> (<em>geobipy.Hitmap</em>) – The hitmap to add to</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.asHistogram2D">
<code class="sig-name descname">asHistogram2D</code><span class="sig-paren">(</span><em class="sig-param">variance</em>, <em class="sig-param">Hist</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.asHistogram2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a Hitmap from the model given the variance of each layer.</p>
<p>For each depth, creates a normal distribution with a mean equal to the interpolated parameter
at that depth and variance specified with variance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>variance</strong> (<em>array_like</em>) – The variance of each layer</p></li>
<li><p><strong>Hitmap</strong> (<em>geobipy.Hitmap</em>) – Hitmap to convert the model to.
Must be instantiated before calling so that the model can be interpolated correctly</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.createHdf">
<code class="sig-name descname">createHdf</code><span class="sig-paren">(</span><em class="sig-param">parent</em>, <em class="sig-param">myName</em>, <em class="sig-param">withPosterior=True</em>, <em class="sig-param">nRepeats=None</em>, <em class="sig-param">fillvalue=None</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.createHdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the Metadata for a Model1D in a HDF file</p>
<p>Creates a new group in a HDF file under h5obj.
A nested heirarchy will be created.
This method can be used in an MPI parallel environment, if so however,
a) the hdf file must have been opened with the mpio driver, and
b) createHdf must be called collectively,
i.e., called by every core in the MPI communicator that was used to open the file.
In order to create large amounts of empty space before writing to it in parallel,
the nRepeats parameter will extend the memory in the first dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5obj</strong> (<em>h5py._hl.files.File</em><em> or </em><em>h5py._hl.group.Group</em>) – A HDF file or group object to create the contents in.</p></li>
<li><p><strong>myName</strong> (<em>str</em>) – The name of the group to create.</p></li>
<li><p><strong>nRepeats</strong> (<em>int</em><em>, </em><em>optional</em>) – Inserts a first dimension into the first dimension of each attribute of the Model1D of length nRepeats.
This can be used to extend the available memory of the Model1D so that multiple MPI ranks can write to
their respective parts in the extended memory.</p></li>
<li><p><strong>fillvalue</strong> (<em>number</em><em>, </em><em>optional</em>) – Initializes the memory in file with the fill value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method can be used in serial and MPI. As an example in MPI.
Given 10 MPI ranks, each with a 10 length array, it is faster to create a 10x10 empty array,
and have each rank write its row. Rather than creating 10 separate length 10 arrays because
the overhead when creating the file metadata can become very cumbersome if done too many times.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">geobipy</span> <span class="kn">import</span> <span class="n">Model1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a holder for models in memory with more layers than you will expect.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span> <span class="o">=</span> <span class="n">Model1D</span><span class="p">(</span><span class="n">nCells</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># This is a collective open of data in the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;mpio&#39;</span><span class="p">,</span><span class="n">comm</span><span class="o">=</span><span class="n">world</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Collective creation of space(padded by number of mpi ranks)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span><span class="o">.</span><span class="n">createHdf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">nRepeats</span><span class="o">=</span><span class="n">world</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># In a non collective region, we can write to different sections of x in the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fake a non collective region</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">noncollectivewrite</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Each rank carries out this code, but it&#39;s not collective.</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">model</span><span class="o">.</span><span class="n">writeHdf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span>  <span class="n">index</span><span class="o">=</span><span class="n">world</span><span class="o">.</span><span class="n">rank</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noncollectivewrite</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.deepcopy">
<code class="sig-name descname">deepcopy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.deepcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a deepcopy</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>out</strong> – Deepcopy of Model1D</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>geobipy.Model1D</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.deleteLayer">
<code class="sig-name descname">deleteLayer</code><span class="sig-paren">(</span><em class="sig-param">i</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.deleteLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a layer from the model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> (<em>int</em>) – The layer to remove.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Model with layer removed.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>geobipy.Model1D</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.depthFromThickness">
<code class="sig-name descname">depthFromThickness</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.depthFromThickness" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the thicknesses of each layer, create the depths to each interface. The last depth is inf for the halfspace.</p>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.evaluateHitmapPrior">
<code class="sig-name descname">evaluateHitmapPrior</code><span class="sig-paren">(</span><em class="sig-param">Hitmap</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.evaluateHitmapPrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates the model parameters against a hitmap.</p>
<p>Given a Hitmap describing the probability of the parameters with depth, evaluate the current model using the grid cells it passes through.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>Hitmap</strong> (<em>geobipy.Hitmap</em>) – A 2D hitmap with y axis depth, and x axis parameter to evaluate the probability of the model given the hitmap</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – The probability of the model given the hitmap.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.float64</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.fromHdf">
<code class="sig-name descname">fromHdf</code><span class="sig-paren">(</span><em class="sig-param">grp</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.fromHdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the class from a HDF group</p>
<p>Given the HDF group object, read the contents into an Model1D class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5obj</strong> (<em>h5py._hl.group.Group</em>) – A HDF group object to write the contents to.</p></li>
<li><p><strong>index</strong> (<em>slice</em><em>, </em><em>optional</em>) – If the group was created using the nRepeats option, index specifies the index’th entry from which to read the data.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.getParMeshXIndex">
<code class="sig-name descname">getParMeshXIndex</code><span class="sig-paren">(</span><em class="sig-param">mesh</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.getParMeshXIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate the model parameters to a 2D rectilinear mesh.</p>
<p>Uses piece wise constant interpolation of the parameter-depth profile to the y axis of the mesh.
Then the indices into the mesh x axis for those interpolated values are returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mesh</strong> (<em>geobipy.RectilinearMesh2D</em>) – A mesh to interpolate to.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – The indices into mesh.x after interpolating the model parameters to the mesh.y axis.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.gradientProbability">
<code class="sig-name descname">gradientProbability</code><span class="sig-paren">(</span><em class="sig-param">log=True</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.gradientProbability" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the prior for the gradient of the parameter with depth</p>
<p><strong>Prior on the gradient of the physical parameter with depth</strong></p>
<p>If instead we wish to apply a multivariate normal distribution to the gradient of the parameter with depth we get</p>
<div class="math notranslate nohighlight" id="equation-gradient1">
<span class="eqno">(1)<a class="headerlink" href="#equation-gradient1" title="Permalink to this equation">¶</a></span>\[p(\boldsymbol{\sigma} | k, I) = \left[(2\pi)^{k-1} |\boldsymbol{C}_{\nabla_{z}}|\right]^{-\frac{1}{2}} e ^{-\frac{1}{2}(\nabla_{z} \boldsymbol{\sigma})^{T} \boldsymbol{C}_{\nabla_{z}}^{-1} (\nabla_{z}\boldsymbol{\sigma})}\]</div>
<p>where the parameter gradient <span class="math notranslate nohighlight">\(\nabla_{z}\sigma\)</span> at the ith layer is computed via</p>
<div class="math notranslate nohighlight" id="equation-dpdz1">
<span class="eqno">(2)<a class="headerlink" href="#equation-dpdz1" title="Permalink to this equation">¶</a></span>\[\nabla_{z}^{i}\sigma = \frac{\sigma_{i+1} - \sigma_{i}}{h_{i} - h_{min}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{i+1}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{i}\)</span> are the log-parameters on either side of an interface, <span class="math notranslate nohighlight">\(h_{i}\)</span> is the log-thickness of the ith layer, and <span class="math notranslate nohighlight">\(h_{min}\)</span> is the minimum log thickness defined by</p>
<div class="math notranslate nohighlight" id="equation-minthickness1">
<span class="eqno">(3)<a class="headerlink" href="#equation-minthickness1" title="Permalink to this equation">¶</a></span>\[h_{min} = \frac{z_{max} - z_{min}}{2 k_{max}}\]</div>
<p>where <span class="math notranslate nohighlight">\(k_{max}\)</span> is a maximum number of layers, set to be far greater than the expected final solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>hmin</strong> (<em>float64</em>) – The minimum thickness of any layer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – The probability given the prior on the gradient of the parameters with depth.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.float64</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.hdfName">
<code class="sig-name descname">hdfName</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.hdfName" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a string that describes class instantiation</p>
<p>Returns a string that should be used as an attr[‘repr’] in a HDF group.
This allows reading of the attribute from the hdf file, evaluating it to return an object,
and then reading the hdf contents via the object’s methods.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>out</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.insertLayer">
<code class="sig-name descname">insertLayer</code><span class="sig-paren">(</span><em class="sig-param">z</em>, <em class="sig-param">par=None</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.insertLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a new layer into a model at a given depth</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>numpy.float64</em>) – Depth at which to insert a new interface</p></li>
<li><p><strong>par</strong> (<em>numpy.float64</em><em>, </em><em>optional</em>) – Value of the parameter for the new layer
If None, The value of the split layer is duplicated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Model with inserted layer.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>geobipy.Model1D</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.interpPar2Mesh">
<code class="sig-name descname">interpPar2Mesh</code><span class="sig-paren">(</span><em class="sig-param">par</em>, <em class="sig-param">mesh</em>, <em class="sig-param">matchTop=False</em>, <em class="sig-param">bound=False</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.interpPar2Mesh" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate the model parameters to a 2D rectilinear mesh.</p>
<p>Uses piece wise constant interpolation of the parameter-depth profile to the y axis of the mesh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>par</strong> (<em>geobipy.StatArray</em>) – The values to interpolate to the mesh y axis. Must have length Model1D.nCells.</p></li>
<li><p><strong>mesh</strong> (<em>geobipy.RectilinearMesh2D</em>) – A mesh to interpolate to.</p></li>
<li><p><strong>matchTop</strong> (<em>bool</em><em>, </em><em>optional</em>) – Force the mesh y axis and top of the model to match.</p></li>
<li><p><strong>bound</strong> (<em>bool</em><em>, </em><em>optional</em>) – Interpolated values above the top of the model are nan.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – The interpolated model parameters at each y axis value of the mesh.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.isInsideConfidence">
<code class="sig-name descname">isInsideConfidence</code><span class="sig-paren">(</span><em class="sig-param">Hitmap</em>, <em class="sig-param">percent=95.0</em>, <em class="sig-param">log=None</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.isInsideConfidence" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that the model is insde the specified confidence region of a 2D hitmap</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Hitmap</strong> (<em>geobipy.Hitmap2D</em>) – The hitmap to check against.</p></li>
<li><p><strong>percent</strong> (<em>np.float</em><em>, </em><em>optional</em>) – The confidence interval percentage.</p></li>
<li><p><strong>log</strong> (<em>bool</em><em>, </em><em>optional</em>) – Whether to take the parameters to a log base (log).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – All parameter values are within the confidence intervals.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.localParameterVariance">
<code class="sig-name descname">localParameterVariance</code><span class="sig-paren">(</span><em class="sig-param">dataPoint</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.localParameterVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a localized inverse Hessian matrix using a dataPoint and the current realization of the Model1D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataPoint</strong> (<em>geobipy.DataPoint</em>) – The data point to use when computing the local estimate of the variance.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Inverse Hessian matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.pad">
<code class="sig-name descname">pad</code><span class="sig-paren">(</span><em class="sig-param">size</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.pad" title="Permalink to this definition">¶</a></dt>
<dd><p>Copies the properties of a model including all priors or proposals, but pads memory to the given size</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>size</strong> (<em>int</em>) – Create memory upto this size.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Padded model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>geobipy.Model1D</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.pcolor">
<code class="sig-name descname">pcolor</code><span class="sig-paren">(</span><em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.pcolor" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a pseudocolour plot of the 1D Model.</p>
<p>Can take any other matplotlib arguments and keyword arguments e.g. cmap etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<em>scalar or array_like, optional</em>) – If alpha is scalar, behaves like standard matplotlib alpha and opacity is applied to entire plot
If array_like, each pixel is given an individual alpha value.</p></li>
<li><p><strong>log</strong> (<em>‘e’ or float, optional</em>) – Take the log of the colour to a base. ‘e’ if log = ‘e’, and a number e.g. log = 10.
Values in c that are &lt;= 0 are masked.</p></li>
<li><p><strong>equalize</strong> (<em>bool, optional</em>) – Equalize the histogram of the colourmap so that all colours have an equal amount.</p></li>
<li><p><strong>nbins</strong> (<em>int, optional</em>) – Number of bins to use for histogram equalization.</p></li>
<li><p><strong>xscale</strong> (<em>str, optional</em>) – Scale the x axis? e.g. xscale = ‘linear’ or ‘log’</p></li>
<li><p><strong>yscale</strong> (<em>str, optional</em>) – Scale the y axis? e.g. yscale = ‘linear’ or ‘log’.</p></li>
<li><p><strong>flipX</strong> (<em>bool, optional</em>) – Flip the X axis</p></li>
<li><p><strong>flipY</strong> (<em>bool, optional</em>) – Flip the Y axis</p></li>
<li><p><strong>grid</strong> (<em>bool, optional</em>) – Plot the grid</p></li>
<li><p><strong>noColorbar</strong> (<em>bool, optional</em>) – Turn off the colour bar, useful if multiple customPlots plotting routines are used on the same figure.</p></li>
<li><p><strong>trim</strong> (<em>bool, optional</em>) – Set the x and y limits to the first and last non zero values along each axis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matplotlib.Axes</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ax</p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">matplotlib.pyplot.pcolormesh()</span></code></dt><dd><p>For additional keyword arguments you may use.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.perturb">
<code class="sig-name descname">perturb</code><span class="sig-paren">(</span><em class="sig-param">datapoint=None</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.perturb" title="Permalink to this definition">¶</a></dt>
<dd><p>Perturb a model’s structure and parameter values.</p>
<p>Uses a stochastic newtown approach if a datapoint is provided.
Otherwise, uses the existing proposal distribution attached to
self.par to generate new values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataPoint</strong> (<em>geobipy.DataPoint</em><em>, </em><em>optional</em>) – The datapoint to use to perturb using a stochastic Newton approach.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>remappedModel</strong> (<em>geobipy.Model1D</em>) – The current model remapped onto the perturbed dimension.</p></li>
<li><p><strong>perturbedModel</strong> (<em>geobipy.Model1D</em>) – The model with perturbed structure and parameter values.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.perturbStructure">
<code class="sig-name descname">perturbStructure</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.perturbStructure" title="Permalink to this definition">¶</a></dt>
<dd><p>Perturb a model</p>
<p>Generates a new model by perturbing the current model based on four probabilities.
The probabilities correspond to
* Birth, the insertion of a new layer into the model
* Death, the deletion of a layer from the model
* Change, change one the existing interfaces
* No change, do nothing and return the original</p>
<p>The method self.makePerturbable must be used before calling self.perturb.</p>
<p>The perturbation starts by generating a random number from a uniform distribution to determine which cycle to go through.
If a layer is created, or an interface perturbed, any resulting layer thicknesses must be greater than the minimum thickness <span class="math notranslate nohighlight">\(h_{min}\)</span>.
If the new layer thickness test fails, the birth or perturbation tries again. If the cycle fails after 10 tries, the entire process begins again
such that a death, or no change is possible thus preventing any neverending cycles.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>out[0]</strong> – The perturbed model</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><a class="reference internal" href="#geobipy.src.classes.model.Model1D.Model1D" title="geobipy.src.classes.model.Model1D.Model1D">Model1D</a></p>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">geobipy.Model1D.makePerturbable()</span></code></dt><dd><p>Must be used before calling self.perturb</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.plot">
<code class="sig-name descname">plot</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a 1D model parameters as a line against depth</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>reciprocateX</strong> (<em>bool</em><em>, </em><em>optional</em>) – Take the reciprocal of the x axis</p></li>
<li><p><strong>xscale</strong> (<em>str</em><em>, </em><em>optional</em>) – Scale the x axis? e.g. xscale = ‘linear’ or ‘log’</p></li>
<li><p><strong>yscale</strong> (<em>str</em><em>, </em><em>optional</em>) – Scale the y axis? e.g. yscale = ‘linear’ or ‘log’</p></li>
<li><p><strong>flipX</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flip the X axis</p></li>
<li><p><strong>flipY</strong> (<em>bool</em><em>, </em><em>optional</em>) – Flip the Y axis</p></li>
<li><p><strong>noLabels</strong> (<em>bool</em><em>, </em><em>optional</em>) – Do not plot the labels</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.priorProbability">
<code class="sig-name descname">priorProbability</code><span class="sig-paren">(</span><em class="sig-param">pPrior</em>, <em class="sig-param">gPrior</em>, <em class="sig-param">log=True</em>, <em class="sig-param">verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.priorProbability" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the prior probability for the 1D Model.</p>
<p>The following equation describes the components of the prior that correspond to the Model1D,</p>
<div class="math notranslate nohighlight">
\[p(k | I)p(\boldsymbol{z}| k, I)p(\boldsymbol{\sigma} | k, \boldsymbol{z}, I),\]</div>
<p>where <span class="math notranslate nohighlight">\(k, I, \boldsymbol{z}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{\sigma}\)</span> are the number of layers, prior information, interface depth, and physical property, respectively.</p>
<p>The multiplication here can be turned into a summation by taking the log of the components.</p>
<p><strong>Prior on the number of layers</strong></p>
<p>Uninformative prior using a uniform distribution.</p>
<div class="math notranslate nohighlight" id="equation-layers">
<span class="eqno">(4)<a class="headerlink" href="#equation-layers" title="Permalink to this equation">¶</a></span>\[p(k | I) =
\begin{cases}
\frac{1}{k_{max} - 1} &amp; \quad 1 \leq k \leq k_{max} \newline
0 &amp; \quad otherwise
\end{cases}.\]</div>
<p><strong>Prior on the layer interface depths</strong></p>
<p>We use order statistics for the prior on layer depth interfaces.</p>
<div class="math notranslate nohighlight" id="equation-depth">
<span class="eqno">(5)<a class="headerlink" href="#equation-depth" title="Permalink to this equation">¶</a></span>\[p(\boldsymbol{z} | k, I) = \frac{(k -1)!}{\prod_{i=0}^{k-1} \Delta z_{i}},\]</div>
<p>where the numerator describes the number of ways that <span class="math notranslate nohighlight">\((k - 1)\)</span> interfaces can be ordered and
<span class="math notranslate nohighlight">\(\Delta z_{i} = (z_{max} - z_{min}) - 2 i h_{min}\)</span> describes the depth interval that is available to place a layer when there are already i interfaces in the model</p>
<p><strong>Prior on the physical parameter</strong></p>
<p>If we use a multivariate normal distribution to describe the joint prior pdf for log-parameter values in all layers we use,</p>
<div class="math notranslate nohighlight" id="equation-parameter">
<span class="eqno">(6)<a class="headerlink" href="#equation-parameter" title="Permalink to this equation">¶</a></span>\[p(\boldsymbol{\sigma} | k, I) = \left[(2\pi)^{k} |\boldsymbol{C}_{\boldsymbol{\sigma}0}|\right]^{-\frac{1}{2}} e ^{-\frac{1}{2}(\boldsymbol{\sigma} - \boldsymbol{\sigma}_{0})^{T} \boldsymbol{C}_{\boldsymbol{\sigma} 0}^{-1} (\boldsymbol{\sigma} - \boldsymbol{\sigma}_{0})}\]</div>
<p><strong>Prior on the gradient of the physical parameter with depth</strong></p>
<p>If instead we wish to apply a multivariate normal distribution to the gradient of the parameter with depth we get</p>
<div class="math notranslate nohighlight" id="equation-gradient">
<span class="eqno">(7)<a class="headerlink" href="#equation-gradient" title="Permalink to this equation">¶</a></span>\[p(\boldsymbol{\sigma} | k, I) = \left[(2\pi)^{k-1} |\boldsymbol{C}_{\nabla_{z}}|\right]^{-\frac{1}{2}} e ^{-\frac{1}{2}(\nabla_{z} \boldsymbol{\sigma})^{T} \boldsymbol{C}_{\nabla_{z}}^{-1} (\nabla_{z}\boldsymbol{\sigma})}\]</div>
<p>where the parameter gradient <span class="math notranslate nohighlight">\(\nabla_{z}\sigma\)</span> at the ith layer is computed via</p>
<div class="math notranslate nohighlight" id="equation-dpdz">
<span class="eqno">(8)<a class="headerlink" href="#equation-dpdz" title="Permalink to this equation">¶</a></span>\[\nabla_{z}^{i}\sigma = \frac{\sigma_{i+1} - \sigma_{i}}{h_{i} - h_{min}}\]</div>
<p>where <span class="math notranslate nohighlight">\(\sigma_{i+1}\)</span> and <span class="math notranslate nohighlight">\(\sigma_{i}\)</span> are the log-parameters on either side of an interface, <span class="math notranslate nohighlight">\(h_{i}\)</span> is the log-thickness of the ith layer, and <span class="math notranslate nohighlight">\(h_{min}\)</span> is the minimum log thickness defined by</p>
<div class="math notranslate nohighlight" id="equation-minthickness">
<span class="eqno">(9)<a class="headerlink" href="#equation-minthickness" title="Permalink to this equation">¶</a></span>\[h_{min} = \frac{z_{max} - z_{min}}{2 k_{max}}\]</div>
<p>where <span class="math notranslate nohighlight">\(k_{max}\)</span> is a maximum number of layers, set to be far greater than the expected final solution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sPar</strong> (<em>bool</em>) – Evaluate the prior on the parameters <a class="reference internal" href="#equation-parameter">(6)</a> in the final probability</p></li>
<li><p><strong>sGradient</strong> (<em>bool</em>) – Evaluate the prior on the parameter gradient <a class="reference internal" href="#equation-gradient">(7)</a> in the final probability</p></li>
<li><p><strong>components</strong> (<em>bool</em><em>, </em><em>optional</em>) – Return all components used in the final probability as well as the final probability</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>probability</strong> (<em>numpy.float64</em>) – The probability</p></li>
<li><p><strong>components</strong> (<em>array_like, optional</em>) – Return the components of the probability, i.e. the individually evaluated priors as a second return argument if comonents=True on input.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.proposalProbabilities">
<code class="sig-name descname">proposalProbabilities</code><span class="sig-paren">(</span><em class="sig-param">dataPoint</em>, <em class="sig-param">remappedModel</em>, <em class="sig-param">burnedIn</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.proposalProbabilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the forward and reverse proposal probabilities for the model</p>
<p>Returns the denominator and numerator for the model’s components of the proposal ratio.</p>
<div class="math notranslate nohighlight" id="equation-proposal-numerator">
<span class="eqno">(10)<a class="headerlink" href="#equation-proposal-numerator" title="Permalink to this equation">¶</a></span>\[q(k, \boldsymbol{z} | \boldsymbol{m}^{'})\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-proposal-denominator">
<span class="eqno">(11)<a class="headerlink" href="#equation-proposal-denominator" title="Permalink to this equation">¶</a></span>\[q(k^{'}, \boldsymbol{z}^{'} | \boldsymbol{m})\]</div>
<p>Each component is dependent on the event that was chosen during perturbation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>datapoint</strong> (<em>geobipy.DataPoint</em>) – The perturbed datapoint that was used to generate self.</p></li>
<li><p><strong>remappedModel</strong> (<em>geobipy.Model1D</em>) – The current model, remapped onto the dimension of self.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>forward</strong> (<em>float</em>) – The forward proposal probability</p></li>
<li><p><strong>reverse</strong> (<em>float</em>) – The reverse proposal probability</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.setPriors">
<code class="sig-name descname">setPriors</code><span class="sig-paren">(</span><em class="sig-param">halfSpaceValue</em>, <em class="sig-param">minDepth</em>, <em class="sig-param">maxDepth</em>, <em class="sig-param">maxLayers</em>, <em class="sig-param">parameterPrior</em>, <em class="sig-param">gradientPrior</em>, <em class="sig-param">parameterLimits=None</em>, <em class="sig-param">minThickness=None</em>, <em class="sig-param">factor=10.0</em>, <em class="sig-param">dzVariance=1.5</em>, <em class="sig-param">prng=None</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.setPriors" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup the priors of a 1D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>halfSpaceValue</strong> (<em>float</em>) – Value of the parameter for the halfspace.</p></li>
<li><p><strong>minDepth</strong> (<em>float64</em>) – Minimum depth possible for the model</p></li>
<li><p><strong>maxDepth</strong> (<em>float64</em>) – Maximum depth possible for the model</p></li>
<li><p><strong>maxLayers</strong> (<em>int</em>) – Maximum number of layers allowable in the model</p></li>
<li><p><strong>parameterPrior</strong> (<em>bool</em>) – Sets a prior on the parameter values</p></li>
<li><p><strong>gradientPrior</strong> (<em>bool</em>) – Sets a prior on the gradient of the parameter values</p></li>
<li><p><strong>parameterLimits</strong> (<em>array_like</em><em>, </em><em>optional</em>) – Length 2 array with the bounds on the parameter values to impose.</p></li>
<li><p><strong>minThickness</strong> (<em>float64</em><em>, </em><em>optional</em>) – Minimum thickness of any layer. If minThickness = None, minThickness is computed from minDepth, maxDepth, and maxLayers (recommended).</p></li>
<li><p><strong>factor</strong> (<em>float</em><em>, </em><em>optional</em>) – Tuning parameter used in the std of the parameter prior.</p></li>
<li><p><strong>prng</strong> (<em>numpy.random.RandomState</em><em>(</em><em>)</em><em>, </em><em>optional</em>) – Random number generator, if none is given, will use numpy’s global generator.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">geobipy.Model1D.perturb()</span></code></dt><dd><p>For a description of the perturbation cycle.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.setProposals">
<code class="sig-name descname">setProposals</code><span class="sig-paren">(</span><em class="sig-param">probabilities</em>, <em class="sig-param">parameterProposal</em>, <em class="sig-param">prng=None</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.setProposals" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup the proposals of a 1D model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>halfSpaceValue</strong> (<em>float</em>) – Value of the parameter for the halfspace.</p></li>
<li><p><strong>probabilities</strong> (<em>array_like</em>) – Probability of birth, death, perturb, and no change for the model
e.g. pWheel = [0.5, 0.25, 0.15, 0.1]</p></li>
<li><p><strong>parameterProposal</strong> (<em>geobipy.Distribution</em>) – The proposal  distribution for the parameter.</p></li>
<li><p><strong>prng</strong> (<em>numpy.random.RandomState</em><em>(</em><em>)</em><em>, </em><em>optional</em>) – Random number generator, if none is given, will use numpy’s global generator.</p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-meth docutils literal notranslate"><span class="pre">geobipy.Model1D.perturb()</span></code></dt><dd><p>For a description of the perturbation cycle.</p>
</dd>
</dl>
</div>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.summary">
<code class="sig-name descname">summary</code><span class="sig-paren">(</span><em class="sig-param">out=False</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Write a summary of the 1D model</p>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.thicknessFromDepth">
<code class="sig-name descname">thicknessFromDepth</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.thicknessFromDepth" title="Permalink to this definition">¶</a></dt>
<dd><p>Given the depths to each interface, compute the layer thicknesses. The last thickness is nan for the halfspace.</p>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.toHdf">
<code class="sig-name descname">toHdf</code><span class="sig-paren">(</span><em class="sig-param">hObj</em>, <em class="sig-param">myName</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.toHdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the Model1D to an HDF object</p>
<p>Creates and writes a new group in a HDF file under h5obj.
A nested heirarchy will be created.
This function modifies the file metadata and writes the contents at the same time and
should not be used in a parallel environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5obj</strong> (<em>h5py._hl.files.File</em><em> or </em><em>h5py._hl.group.Group</em>) – A HDF file or group object to write the contents to.</p></li>
<li><p><strong>myName</strong> (<em>str</em>) – The name of the group to write to.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">geobipy</span> <span class="kn">import</span> <span class="n">Model1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">par</span> <span class="o">=</span> <span class="n">StatArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="s2">&quot;units&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">thk</span> <span class="o">=</span> <span class="n">StatArray</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mod</span> <span class="o">=</span> <span class="n">Model1D</span><span class="p">(</span><span class="n">nCells</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="n">par</span><span class="p">,</span> <span class="n">thickness</span><span class="o">=</span><span class="n">thk</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.unperturb">
<code class="sig-name descname">unperturb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.unperturb" title="Permalink to this definition">¶</a></dt>
<dd><p>After a model has had its structure perturbed, remap the model back its previous state. Used for the reversible jump McMC step.</p>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.updateLocalParameterVariance">
<code class="sig-name descname">updateLocalParameterVariance</code><span class="sig-paren">(</span><em class="sig-param">dataPoint</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.updateLocalParameterVariance" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate a localized Hessian matrix using
a dataPoint and the current realization of the Model1D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataPoint</strong> (<em>geobipy.DataPoint</em>) – The data point to use when computing the local estimate of the variance.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>out</strong> – Hessian matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array_like</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.updatePosteriors">
<code class="sig-name descname">updatePosteriors</code><span class="sig-paren">(</span><em class="sig-param">minimumRatio=0.5</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.updatePosteriors" title="Permalink to this definition">¶</a></dt>
<dd><p>Update any attached posterior distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>minimumRatio</strong> (<em>float</em>) – Only update the depth posterior if the layer parameter ratio
is greater than this number.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="geobipy.src.classes.model.Model1D.Model1D.writeHdf">
<code class="sig-name descname">writeHdf</code><span class="sig-paren">(</span><em class="sig-param">h5obj</em>, <em class="sig-param">myName</em>, <em class="sig-param">withPosterior=True</em>, <em class="sig-param">index=None</em><span class="sig-paren">)</span><a class="headerlink" href="#geobipy.src.classes.model.Model1D.Model1D.writeHdf" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the Metadata for a Model1D in a HDF file</p>
<p>Creates a new group in a HDF file under h5obj.
A nested heirarchy will be created.
This method can be used in an MPI parallel environment, if so however, a) the hdf file must have been opened with the mpio driver,
and b) createHdf must be called collectively, i.e., called by every core in the MPI communicator that was used to open the file.
In order to create large amounts of empty space before writing to it in parallel, the nRepeats parameter will extend the memory
in the first dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>h5obj</strong> (<em>h5py._hl.files.File</em><em> or </em><em>h5py._hl.group.Group</em>) – A HDF file or group object to create the contents in.</p></li>
<li><p><strong>myName</strong> (<em>str</em>) – The name of the group to create.</p></li>
<li><p><strong>fillvalue</strong> (<em>number</em><em>, </em><em>optional</em>) – Initializes the memory in file with the fill value</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This method can be used in serial and MPI. As an example in MPI.
Given 10 MPI ranks, each with a 10 length array, it is faster to create a 10x10 empty array, and have each rank write its row.
Rather than creating 10 separate length 10 arrays because the overhead when creating the file metadata can become very
cumbersome if done too many times.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">geobipy</span> <span class="kn">import</span> <span class="n">Model1D</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mpi4py</span> <span class="kn">import</span> <span class="n">MPI</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">h5py</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span> <span class="o">=</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a holder for models in memory with more layers than you will expect.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span> <span class="o">=</span> <span class="n">Model1D</span><span class="p">(</span><span class="n">nCells</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># This is a collective open of data in the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">fName</span><span class="p">,</span><span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">driver</span><span class="o">=</span><span class="s1">&#39;mpio&#39;</span><span class="p">,</span><span class="n">comm</span><span class="o">=</span><span class="n">world</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Collective creation of space(padded by number of mpi ranks)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tmp</span><span class="o">.</span><span class="n">createHdf</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span> <span class="n">nRepeats</span><span class="o">=</span><span class="n">world</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># In a non collective region, we can write to different sections of x in the file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Fake a non collective region</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">noncollectivewrite</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">world</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># Each rank carries out this code, but it&#39;s not collective.</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">model</span><span class="o">.</span><span class="n">writeHdf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span> <span class="s1">&#39;models&#39;</span><span class="p">,</span>  <span class="n">index</span><span class="o">=</span><span class="n">world</span><span class="o">.</span><span class="n">rank</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">noncollectivewrite</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">world</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">world</span><span class="o">.</span><span class="n">barrier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../pointcloud/pointcloud.html" class="btn btn-neutral float-right" title="Pointcloud classes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="Model_.html" class="btn btn-neutral float-left" title="Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright None

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>